# Claude Code を活用したプロダクト開発プロセス
## — シェアメニュークラフト（MenuCraft AI）開発事例 —

**発表者**: 村田
**日付**: 2026年2月17日 代表者MTG
**対象**: NotebookLM 用ソース資料

---

## 1. はじめに — なぜ Claude Code なのか

### 背景

- シェアメニュークラフト（MenuCraft AI）は、飲食店オーナー向けの AI メニュー画像自動生成 SaaS
- 今回のアプリ開発で **Claude Code を初めて使用**
- 従来のコード手書き開発と比較して、AI コーディングエージェントがどこまで実用レベルかを検証する目的もあった

### Claude Code とは

- Anthropic が提供するCLIベースのAIコーディングエージェント
- ターミナル上で動作し、ファイル読み書き・Git操作・コマンド実行を自律的に行う
- 指示を出すと、コードの生成・修正・テスト・デプロイまで一気通貫で実行可能
- 「会話しながらプロダクトを作る」開発体験

---

## 2. プロジェクト概要

### MenuCraft AI とは

| 項目 | 内容 |
|------|------|
| プロダクト名 | MenuCraft AI（シェアメニュークラフト） |
| 本番URL | https://sharemenu-webapp.vercel.app |
| ターゲット | 飲食店オーナー（30〜60歳、日本市場） |
| 核心機能 | チャットでメニュー情報を伝えると、SNS最適サイズの画像を5種自動生成 |
| 料金モデル | Free（¥0、月10枚）/ Pro（¥700/月、月50枚） |

### 技術スタック

| レイヤー | 技術 |
|---------|------|
| フレームワーク | Next.js 15 (App Router) |
| UI | React 19 + TypeScript |
| スタイル | Tailwind CSS v4 |
| 認証 | NextAuth.js v5 |
| DB | Supabase PostgreSQL + Storage |
| AI | Google Gemini 2.0 Flash |
| 画像処理 | sharp |
| デプロイ | Vercel |
| テスト | Vitest（74テスト） |

### 開発規模（2026-02-16 時点）

| 指標 | 数値 |
|------|------|
| 総コード行数 | 約18,200行（TypeScript/TSX） |
| API エンドポイント | 24本 |
| ページ数 | 22ページ以上（管理画面9ページ含む） |
| コンポーネント | 19ディレクトリ |
| テスト | 8ファイル、74テスト |
| GitHub Issues | 63件（57件クローズ、6件オープン） |
| Pull Requests | 16本（15本マージ済み） |
| DBテーブル | 16テーブル |
| 開発期間 | 2026-02-09 〜 02-16（**約1週間**） |

---

## 3. 開発アプローチ — Claude Code による「エージェントチーム開発」

### 3.1 エージェントロール制によるチーム開発

Claude Code 上で擬似的なチーム体制を構築し、フェーズごとに異なるロールで開発を進めた。

| ロール | 担当領域 | ガイドファイル |
|--------|----------|---------------|
| PdO（プロダクトオーナー） | 要件定義、優先度判断、受入基準 | `docs/agents/pdo.md` |
| デザイナー | デザインシステム、UI パターン | `docs/agents/designer.md` |
| フロントエンド | React/Next.js 実装 | `docs/agents/frontend.md` |
| バックエンド | API、DB、認証 | `docs/agents/backend.md` |
| QA | テスト、品質保証 | `docs/agents/qa.md` |
| UX | ユーザー体験、フロー設計 | `docs/agents/ux.md` |

各ロールの振る舞いを `.md` ファイルで定義し、Claude Code がそのロールに沿って思考・実装するようガイドした。

### 3.2 フェーズ進行

```
Day 1（02-09）:
  フェーズ1: プロダクト企画（3エージェント協働で企画書作成）
  フェーズ2: LP実装（668行、Next.js + Tailwind）
  フェーズ3: 視覚確認

Day 1-2（02-09〜10）:
  DB統合 + 管理画面 + 画像アップロード + Vercel デプロイ
  → 20ファイル、2,300行、12APIエンドポイント一気に実装

Day 2（02-10 午前）:
  MVP残タスク全件完了（Issue #1〜#21 解決）

Day 2（02-10 午後前半）:
  UX改善 + バグ修正（Issue #22〜#30）

Day 2（02-10 午後後半）:
  デザインリフレッシュ Phase A〜C（LP→ダッシュボード→チャット）

Day 3（02-12）:
  Admin ユーザー管理 + 退会機能

Day 4（02-13）:
  Sprint A（管理画面拡充）+ インシデント対応 + Skills整備

Day 5（02-16）:
  Sprint C-2 + モバイル最適化 + マネタイズ設計・実装
```

### 3.3 Issue駆動開発

- 全機能をGitHub Issueで管理（63件作成）
- `/plan-issues` スキルで企画からIssue一括作成
- `/priority-review` スキルで4軸評価（ユーザー価値・収益貢献・技術リスク・実装コスト）でTier分け
- Sprint単位で実装 → PR → マージのサイクルを確立

### 3.4 ブランチ戦略

```
main        ← 本番安定ブランチ
 └─ develop ← 統合ブランチ
     └─ feature/* / design/* / fix/* / refactor/*
```

- feature ブランチは develop にマージ → 安定確認後 main に fast-forward マージ
- main への直接 commit は禁止（docs含め全て develop経由）
- コミットメッセージ規約: `feat:` / `fix:` / `design:` / `docs:` / `refactor:` / `test:`
- ブランチ15本運用、PR 16本を通じた品質管理

---

## 4. 効率よくできたところ

### 4.1 圧倒的な開発スピード

| タスク | 従来見積 | Claude Code 実績 |
|--------|---------|-----------------|
| LP実装（668行、8コンポーネント） | 2〜3日 | 約1時間 |
| DB統合 + 管理画面 + デプロイ（2,300行、20ファイル） | 7〜10営業日 | 1セッション（半日） |
| MVP残タスク18件（Issue #1〜#21） | 5営業日 | 1セッション（半日） |
| UX改善12件（Issue #22〜#30 + 追加3件） | 3〜4営業日 | 1セッション（数時間） |
| デザインリフレッシュ3画面（17ファイル、1,060行） | 3営業日 | 約1.5時間 |

**約1週間で、従来のエンジニア1人なら1〜2ヶ月かかる規模の開発を完了。**

### 4.2 企画→実装の一気通貫

- 要件定義書（22KB）→ プロダクト企画書（27KB）→ LP実装 → DB設計 → デプロイまでを同一セッション内で連続実行
- 企画段階の仮定事項（A-01〜A-10）を明文化し、ペルソナ3名、ユーザーストーリー8エピック、12ヶ月収益シミュレーションまで策定

### 4.3 デザインシステムの確立と横展開

- Phase A でLPのビジュアルパターン（背景ブラー・アクセントバー・ホバーエフェクト等）を確立
- Phase B, C で「強度レベル」（LP > Dashboard > Chat）を設計し、全画面に統一展開
- デザイントークンをCSS変数化（`globals.css`）し、カラー・フォント・アニメーションを一元管理

### 4.4 バグ修正のデバッグ能力

- Issue #22（画像表示バグ）: 3回の修正を経て、Chrome MCP でDOM計算値を調査し `flex-shrink` が根本原因と特定 → `flex-shrink-0` で解決
- Claude Code がブラウザ自動化ツールと連携し、実際の描画結果から原因を逆算するプロセスを自律実行

### 4.5 ドキュメントの自動生成と保守

- WORK_LOG.md（33KB）: 全セッションの詳細な作業記録を自動蓄積
- セッションログ（`docs/session-logs/`）: 日次の実装サマリー・意思決定・残タスクを構造化
- CLAUDE.md（10KB）: プロジェクトガイドとして常に最新状態を維持
- 各種調査ドキュメント（i18n、モバイル最適化、マネタイズ、Stripe連携）も自動作成

---

## 5. 開発するために注意したところ

### 5.1 CLAUDE.md による「プロジェクトの記憶」管理

Claude Code はセッションを跨ぐと前のコンテキストを失う。そのため：

- **CLAUDE.md** にプロジェクトの全体像（技術スタック・ディレクトリ構成・API一覧・デザインシステム・コーディング規約・技術的負債）を集約
- セッション開始時に Claude Code がこのファイルを読むことで、プロジェクトの文脈を即座に復元
- セッション終了時に `/session-wrapup` で CLAUDE.md を更新し、常に最新を保つ

### 5.2 セッション引き継ぎの落とし穴と対策

**2026-02-13 インシデント:**
- セッション引き継ぎ時、前セッションのコンテキストに含まれていた指示書の内容を「実際にファイルを読んだ結果」と Claude Code が誤認
- 存在しないファイルに基づいて実装を開始してしまい、ユーザーの指摘で発覚

**対策として導入したもの:**
1. `/preflight-check` スキル — 作業開始前に指示書の実在確認・ブランチ状態チェックを義務化
2. `/session-wrapup` の拡充 — 引き継ぎ注意事項セクションを追加（参照ファイルの実在確認結果、ブランチ状態を明記）
3. CLAUDE.md への「mainへの直接commit禁止」ルール追記

**教訓:** Claude Code は非常に有能だが、「確認してから動く」というガードレールは人間が設計する必要がある。

### 5.3 settings.local.json による権限管理

`.claude/settings.local.json` で Claude Code に許可する操作を明示的に制御：

```json
{
  "permissions": {
    "allow": [
      "Bash(git add:*)", "Bash(git commit:*)", "Bash(git push:*)",
      "Bash(npm run build:*)", "Bash(npm install:*)",
      "Bash(gh issue create:*)", "Bash(gh issue close:*)",
      "WebFetch(domain:sharemenu-webapp.vercel.app)"
    ]
  }
}
```

- Git操作、npm操作、GitHub CLI、特定ドメインへのWebアクセスのみ許可
- 不用意なシステム操作やセキュリティリスクを防止

### 5.4 Git運用の徹底

- ブランチ戦略を CLAUDE.md に明記し、Claude Code に遵守させた
- main への直接 commit 事故が発生した際、`reset --hard` + force push で ff-only 運用を復旧
- インシデントレポートと振り返りドキュメントを残し、プロセスを改善

### 5.5 ビルド確認の習慣化

- コミット前に `npm run build` を必ず実行するルールを確立
- CLAUDE.md の開発コマンドセクションに「PR前に必ず実行」と明記
- ビルドエラーがあれば Claude Code が自律的に修正するサイクル

---

## 6. MDファイルとSkillsファイルの仕組み

### 6.1 MDファイル体系

Claude Code のプロジェクト理解を支える文書群：

| ファイル | サイズ | 役割 |
|---------|-------|------|
| **CLAUDE.md** | 10.3KB | プロジェクトガイド（技術スタック・構成・API・デザイン・規約）。Claude Code がセッション開始時に最初に読むファイル。「AIエージェントのためのREADME」 |
| **WORK_LOG.md** | 33.7KB | 全セッションの詳細作業記録。各セッションの実装内容・数値サマリー・技術的判断を時系列で蓄積 |
| **docs/product-plan.md** | 27KB | プロダクト企画書（12部構成）。ビジョン・ペルソナ・ロードマップ・収益シミュレーション |
| **docs/agents/*.md** | 6ファイル | エージェントロール定義。PdO・デザイナー・FE・BE・QA・UXの振る舞いガイド |
| **docs/session-logs/*.md** | 日次 | セッション作業記録。実装・意思決定・残タスク・引き継ぎ注意事項 |
| **docs/priority-reviews/*.md** | 適宜 | 優先度レビュー結果。4軸評価・Tier分け・Sprint計画 |
| **docs/\*-plan.md / \*-research.md** | 適宜 | 個別テーマの調査・設計ドキュメント（i18n、モバイル、マネタイズ、Stripe等） |

#### CLAUDE.md の構成

```
1. プロジェクト概要（URL・リポジトリ）
2. 技術スタック（テーブル形式）
3. ブランチ戦略（main/develop/feature/*）
4. ディレクトリ構成（src/ 以下のツリー）
5. デザインシステム（カラートークン・フォント・ビジュアルパターン）
6. データベース構成（16テーブル）
7. APIエンドポイント（24本、テーブル形式）
8. プラン制限（Free/Pro 比較）
9. 開発コマンド
10. コーディング規約
11. 既知の技術的負債（完了済みは打ち消し線）
12. 次回セッションのタスク
13. エージェント構成（ロールと参照ファイル）
```

**ポイント:** このファイルが Claude Code の「長期記憶」として機能する。セッションを跨いでもプロジェクトの文脈を失わないための仕組み。

### 6.2 Skills（スラッシュコマンド）ファイル

`~/.claude/commands/` に配置する `.md` ファイルで、繰り返し実行する開発プロセスを定型化：

| スキル名 | 用途 | 生まれた背景 |
|---------|------|-------------|
| `/preflight-check` | Sprint/タスク開始前の事前チェック（指示書実在確認・ブランチ状態・前Sprint重複チェック） | 02-13のインシデント（存在しないファイルに基づいて作業開始）の再発防止策として新設 |
| `/session-wrapup` | セッション終了時のドキュメント同期（CLAUDE.md更新・作業記録生成・引き継ぎ注意事項） | セッション跨ぎのコンテキストロスを防ぐために設計 |
| `/save-session-log` | セッション作業記録をGitHubに保存 | 作業記録をGitリポジトリに永続化するプロセスを標準化 |
| `/plan-issues` | 企画からGitHub Issue一括作成（要件分析→Issue設計→一括作成） | 企画→Issue化のプロセスを構造化・効率化 |
| `/priority-review` | 開発優先度の全体レビュー（情報収集→4軸評価→Tier分け→Sprint計画） | 優先度判断を属人化させず、再現可能なプロセスにするため |
| `/notion-task` | MTG議事録から Notion タスクリストに自動登録 | MTG後のタスク化作業を自動化 |

**Skills のしくみ:**
- 各スキルは「処理手順」「入力」「出力フォーマット」「注意事項」を定義した Markdown ファイル
- Claude Code でスラッシュコマンドとして呼び出すと、定義された手順に従って自律的に実行
- 「人間が考えたベストプラクティス」をAIが再現可能な形でコード化したもの

---

## 7. 開発プロセスで得た知見

### 7.1 Claude Code が得意なこと

1. **大量のボイラープレートコード生成** — API Route、型定義、コンポーネントのスキャフォールディングが圧倒的に速い
2. **パターンの横展開** — 1つのデザインパターンを確立すれば、全画面に統一的に適用
3. **ドキュメント作成** — 技術仕様書、調査レポート、セッションログの構造化が得意
4. **Issue管理の自動化** — 企画テキストからIssueへの変換、依存関係の整理
5. **デバッグ** — Chrome MCP連携でDOM解析し、CSSバグの根本原因を特定
6. **DB設計→マイグレーション→API→UI** の一気通貫実装

### 7.2 Claude Code で注意すべきこと

1. **セッション跨ぎのコンテキストロス** — CLAUDE.md とSession Logで補完が必須
2. **「確認せずに動く」リスク** — ファイルの存在確認を怠ると事故になる（02-13インシデント）
3. **暴走防止のガードレール** — settings.local.json での権限制限、mainへの直接commit禁止ルール
4. **人間のレビューは不可欠** — AIが出したコードの品質は高いが、ビジネスロジックの妥当性は人間が判断すべき
5. **コスト管理** — 大量のAPI呼び出しが発生するため、使用量の監視が必要

### 7.3 従来開発との比較

| 観点 | 従来の開発 | Claude Code 開発 |
|------|-----------|-----------------|
| コーディング | 人間が手書き | AIが生成、人間がレビュー |
| 設計判断 | 人間が検討→実装 | 人間が方針決定→AIが設計書作成→実装 |
| ドキュメント | 後回しになりがち | 開発と同時に自動生成 |
| テスト | 別途時間確保が必要 | 実装と同時にテスト生成 |
| 作業記録 | 手動で記録（抜け漏れあり） | 自動で構造化された記録が残る |
| リファクタリング | まとまった時間が必要 | 小さな単位で継続的に実施 |
| 開発速度 | 1機能/日 程度 | 複数機能/セッション が可能 |

---

## 8. 今後の開発についての改善点

### 8.1 プロセス面の改善

| 項目 | 現状 | 改善案 |
|------|------|--------|
| テストカバレッジ | 74テスト（基盤のみ） | E2Eテスト導入（Playwright）、カバレッジ80%目標 |
| CI/CD | ビルド確認は手動 | GitHub Actions で PR 時に自動 lint + test + build |
| コードレビュー | Claude Code の自己生成コードをユーザーが確認 | PR テンプレート導入、チェックリスト化 |
| エラー監視 | なし | Sentry 導入で本番エラーを検知 |
| パフォーマンス | 手動チェック | Lighthouse CI で定期計測 |

### 8.2 Claude Code 活用の改善

| 項目 | 改善案 |
|------|--------|
| CLAUDE.md の肥大化対策 | プロジェクト規模に応じて、セクション別ファイルに分割（CLAUDE.md はインデックスのみ） |
| Skills の充実 | `/deploy-check`（デプロイ前チェック）、`/code-review`（自動コードレビュー）の追加 |
| エージェントロールの深化 | 各ロールの判断基準をより具体的に記述し、ロール間の連携パターンを定義 |
| セッション設計 | 1セッション = 1Sprint を基本とし、スコープを事前に明確化 |
| インシデント対応の体系化 | インシデント発生時のエスカレーション手順をスキル化 |

### 8.3 プロダクト面の次ステップ

| 優先度 | タスク | 概要 |
|--------|-------|------|
| 高 | 本番移行 Phase 1-2 | Vercel/Supabase Pro化 + Stripe決済連携 |
| 高 | Sprint D | ダークモード対応（CSS影響大・事前設計必要） |
| 中 | 多言語対応（i18n） | 調査・設計完了済み。Phase 3以降で本格対応 |
| 中 | Gallery機能拡充 | 画像共有・いいね・保存のUX改善 |
| 低 | オンボーディング | 初回ユーザーのガイドフロー |

---

## 9. まとめ — Claude Code が変えた開発の形

### 数字で見る成果

- **開発期間**: 約1週間（02-09〜02-16）
- **総コード**: 約18,200行のTypeScript
- **機能数**: 24 API + 22ページ + 74テスト
- **Issue消化**: 63件中57件クローズ
- **ドキュメント**: 28本のMDファイル（合計200KB超）

### 本質的な変化

1. **「書く」から「指揮する」へ** — エンジニアの役割がコード記述から、方針決定・品質管理・プロセス設計にシフト
2. **ドキュメント駆動開発** — CLAUDE.md・Skills・Agent MDが開発の「設計図」として機能し、AI・人間双方の共通認識基盤になる
3. **失敗からの自動学習** — インシデント → 振り返り → Skills/ルール追加 → 再発防止という改善サイクルが回る
4. **開発速度の非線形な向上** — 単にコードを速く書くだけでなく、企画・設計・実装・テスト・ドキュメントの全工程で加速

### 留意点

- Claude Code は「超高速な実行者」であり、**判断者は人間**
- ガードレール（CLAUDE.md、Skills、settings.json、ブランチルール）なしでは事故が起きる
- 「AIに任せきり」ではなく「AIと協働する仕組みを設計する」ことが成功の鍵

---

## 付録A: ファイル構成一覧

```
プロジェクトルート/
├── CLAUDE.md                    # プロジェクトガイド（AIの長期記憶）
├── WORK_LOG.md                  # 開発作業記録
├── README.md                    # 技術README
├── .claude/
│   └── settings.local.json      # Claude Code 権限設定
├── docs/
│   ├── product-plan.md          # プロダクト企画書
│   ├── agents/                  # エージェントロール定義
│   │   ├── pdo.md               #   プロダクトオーナー
│   │   ├── designer.md          #   デザイナー
│   │   ├── frontend.md          #   フロントエンド
│   │   ├── backend.md           #   バックエンド
│   │   ├── qa.md                #   QA
│   │   └── ux.md                #   UX
│   ├── session-logs/            # セッション作業記録
│   │   ├── 2026-02-13.md
│   │   ├── 2026-02-13-incident-report.md
│   │   ├── 2026-02-13-retrospective.md
│   │   └── 2026-02-16.md
│   ├── priority-reviews/        # 優先度レビュー
│   ├── monetization-plan.md     # マネタイズ設計
│   ├── mobile-optimization-plan.md
│   ├── i18n-research.md         # i18n調査
│   ├── stripe-integration-research.md
│   └── production-migration-plan.md
└── ~/.claude/commands/          # Skillsファイル（スラッシュコマンド）
    ├── preflight-check.md       # 作業前チェック
    ├── session-wrapup.md        # セッション終了処理
    ├── save-session-log.md      # ログ保存
    ├── plan-issues.md           # Issue一括作成
    ├── priority-review.md       # 優先度レビュー
    └── notion-task.md           # Notionタスク登録
```

## 付録B: 開発タイムライン

```
02-09 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  [企画] 要件定義書分析 → プロダクト企画書作成（3エージェント協働）
  [実装] LP実装（668行、8コンポーネント）
  [実装] DB統合 + 管理画面 + 画像アップロード（2,300行、12API）

02-10 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  [実装] MVP残タスク全件完了（Issue #1〜#21、18件）
  [実装] UX改善 + バグ修正（Issue #22〜#30、12件）
  [デザイン] デザインリフレッシュ Phase A〜C（3画面統一）
  [インフラ] Vercel本番デプロイ
  📊 この時点: 8,173行、50コミット、30 Issues完了

02-12 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  [実装] Admin ユーザー管理 + 退会機能（1,210行、3API）
  [DB] マイグレーション（deleted_at カラム）

02-13 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  [実装] Sprint A（管理画面拡充6タスク）
  [インシデント] 存在しないファイルに基づく作業 → 発覚・停止
  [プロセス] /preflight-check 新設、/session-wrapup 拡充
  [修正] ブランチ状態修正（ff-only運用復旧）

02-16 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  [実装] Auth共通化 + リリースノート機能
  [デザイン] モバイル最適化 P0+P1（9ファイル）
  [企画] マネタイズ設計（フリーミアム案B）+ 実装
  [調査] i18n調査、Stripe連携リサーチ、本番移行計画
  📊 この時点: 18,200行、63 Issues、16 PRs
```

---

*本資料は NotebookLM のソースとして使用することを想定しています。*
*Claude Code セッション内で自動生成されました。*
