# インシデントレポート — 2026-02-13

## 概要

エンジニアエージェントが、**存在しない指示書ファイルに基づいて実装作業を開始してしまった**事象。

---

## 発生タイムライン

1. **ユーザーからの指示**: 「次の作業を `docs/` フォルダのドキュメントから見つけて進めてくれますか」と依頼を受けた。ユーザーは `docs/sprint-b-instructions.md` というファイル名を明示的に伝えた。

2. **エージェントの行動**: `Read` ツールでファイルを読み取り、内容を確認した**つもりだった**。しかし実際にはファイルは読めておらず、**前セッションから引き継がれた会話コンテキスト（セッション復元用サマリー）** に含まれていた `sprint-b-instructions.md` の内容をそのまま「読んだ結果」と誤認した。

3. **作業開始**: ファイルの存在を検証せず、`feature/sprint-b` ブランチを作成し、Sprint B Task 1（ウェルカムエリア刷新）の実装を開始・完了した。

4. **ユーザーの指摘**: ユーザーから「午前中の作業をもう一回やっていない？」と指摘を受けた。

5. **ファイル不在の発覚**: 改めて `docs/sprint-b-instructions.md` の存在を確認したところ、ディスク上に存在しないことが判明。ユーザーに作業停止を指示された。

---

## 影響範囲

**ブランチ**: `feature/sprint-b`（develop から分岐、未コミット・未プッシュ）

**変更されたファイル（未コミット）**:

| ファイル | 変更内容 |
|---------|---------|
| `CLAUDE.md` | 1行追加 |
| `src/lib/greeting.ts` | 夜間挨拶変更 + Free上限メッセージ追加 |
| `src/__tests__/lib/greeting.test.ts` | テスト更新 |
| `src/hooks/useDashboardData.ts` | userRole state 追加 |
| `src/components/dashboard/DashboardHeader.tsx` | Props追加、fadeInUp、Freeプラン判定 |
| `src/app/dashboard/page.tsx` | userRoleをDashboardHeaderに渡す変更 |

**develop / main への影響**: なし（コミット・プッシュしていない）

---

## 根本原因

- このセッションは前セッションのコンテキストを引き継いで開始された。その引き継ぎデータ内に `sprint-b-instructions.md` の全文が含まれていた。
- エージェントはファイルを `Read` ツールで実際に開いて確認する手順を踏まず、コンテキスト内の情報を「読み取り済みの内容」と誤認して作業を進めた。
- ユーザーがファイル名を示した時点で、**まずファイルの実在を確認すべきだったが、それを怠った**。

---

## 現在の状態（対応後）

- 変更は `git stash drop` で破棄済み
- develop / main は影響なし
- `docs/sprint-b-instructions.md` は hotfix 手順で develop に取り込み済み

---

## 再発防止策

1. **ファイル参照時は必ず `Read` ツールで実ファイルを開き、存在と内容を確認する**。セッション引き継ぎコンテキストの情報を鵜呑みにしない。
2. **作業開始前に、指示書の存在・内容をユーザーに確認する**。特にセッション跨ぎの場合。
3. **ファイルが見つからない場合は、作業を開始せずユーザーに報告する**。
4. `/preflight-check` スキルを新設し、Sprint/タスク開始前の事前チェックを標準化した。
